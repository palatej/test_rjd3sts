nr055<-c(115.2,110.4,111.5,127.9,150,149.5,139.5,144.6,176,173.2,172.7,143.5,135.3,174.5,164.5,179.1,
         164.8,168.7,115.8,163.7,156.3,129.3,125.5,120.8,84.4,93.6,83,120.5,110.9,115.3,108.5,107.7,
         99.8,98.7,107.7,102.1,95.9,92.2,99.3,92.8,127.4,105.2,108,118.1,108.5,133.2,127.3,110.1,103.1,
         99.8,101.1,105.8,101.6,110.9,122.9,129.8,129.4,149.7,141.4,125,122.3,110.3,108.9,122.8,115.8,
         116.9,134.2,158.8,141.9,174.1,178.6,154.5)

h<-c(.042,.042,.067,.122,.129,.135,
     .152,.168,.173,.177,.179,.179,
     .179,.182,.179,.177,.175,.170,
     .162,.165,.152,.149,.149,.135,
     .144,.140,.144,.159,.152,.149,
     .144,.129,.144,.140,.140,.149,
     .149,.156,.152,.152,.156,.165,
     .159,.159,.159,.149,.144,.144,
     .152,.159,.156,.156,.162,.156,
     .165,.162,.165,.168,.170,.159,
     .144,.149,.144,.144,.129,.135,
     .140,.135,.149,.140,.140,.115)

# create the model
y<-log(nr055)
model<-rjd3sts::model()
# create the components and add them to the model
eq<-rjd3sts::equation("eq")
rjd3sts::add(model, rjd3sts::sarima("airline", 12, c(0,1,1), c(0,1,1)))
rjd3sts::add(model, rjd3sts::ar("ar", c(0.6, 0.246), TRUE, 0.34488, TRUE))
rjd3sts::add_equation(eq, "airline")
rjd3sts::add_equation(eq, "ar", loading = rjd3sts::var_loading(pos=0, weights = h))
rjd3sts::add(model, eq)
#estimate the model
rslt<-rjd3sts::estimate(model, y, concentrated=FALSE, precision = 1e-10)
